<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Memory Helix</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@300;800&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #ff4d6d; }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: #000; overflow: hidden; color: #fff;
            font-family: 'Montserrat', sans-serif;
        }

        /* 3D Container */
        #viewport {
            position: absolute; width: 100%; height: 100%;
            perspective: 1000px; transform-style: preserve-3d;
            display: flex; align-items: center; justify-content: center;
        }

        #world {
            position: relative; width: 100%; height: 100%;
            transform-style: preserve-3d;
            transition: transform 2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* The Surprise Message - High End Glow */
        #message {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            text-align: center; z-index: 1000; opacity: 0;
            transition: all 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
        }

        .boom-active #message { opacity: 1; transform: translate(-50%, -50%) scale(1); }

        h1 {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(3rem, 15vw, 6rem); color: var(--accent); margin: 0;
            filter: drop-shadow(0 0 20px var(--accent));
        }

        /* Cinematic Photo Cards */
        .card {
            position: absolute; width: 220px; height: 280px;
            background: #fff; padding: 10px; padding-bottom: 40px;
            box-shadow: 0 0 40px rgba(0,0,0,1);
            border-radius: 2px; transform-style: preserve-3d;
            opacity: 0; transition: opacity 1s, transform 2s;
        }

        .card img { width: 100%; height: 100%; object-fit: cover; }

        /* Flare Effect */
        #flash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, #fff, var(--accent), #000);
            z-index: 2000; opacity: 0; pointer-events: none;
        }

        /* Heart Vortex */
        .vortex-heart {
            position: absolute; color: var(--accent);
            pointer-events: none; font-size: 20px;
        }

        #reload {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            background: none; border: 1px solid var(--accent); color: var(--accent);
            padding: 10px 30px; border-radius: 50px; cursor: pointer;
            text-transform: uppercase; letter-spacing: 4px; font-size: 10px;
            opacity: 0; transition: 2s; z-index: 3000;
        }

        .boom-active #reload { opacity: 1; }

        @media (max-width: 600px) { .card { width: 140px; height: 180px; } }
    </style>
</head>
<body>

<div id="flash"></div>
<div id="message">
    <h1>Our Forever</h1>
    <p style="letter-spacing: 10px; font-weight: 300;">THE MASTERPIECE OF MY LIFE</p>
</div>
<button id="reload" onclick="location.reload()">Reset Timeline</button>

<div id="viewport">
    <div id="world"></div>
</div>

<script>
    const world = document.getElementById('world');
    const flash = document.getElementById('flash');
    const msg = document.getElementById('message');
    const total = 20;
    let current = 20;
    let cards = [];

    function buildHelix() {
        if (current < 1) {
            setTimeout(triggerBoom, 4000);
            return;
        }

        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `<img src="${current}.jpeg">`;
        world.appendChild(card);
        cards.push(card);

        // HELIX MATH: Distributes cards in a vertical 3D spiral
        const theta = (total - current) * 0.5; // Spiral rotation
        const y = (current - total / 2) * 120; // Vertical spacing
        const radius = window.innerWidth > 600 ? 500 : 300;
        
        const x = Math.cos(theta) * radius;
        const z = Math.sin(theta) * radius;

        // Animate from center to helix position
        setTimeout(() => {
            card.style.opacity = "1";
            card.style.transform = `translate3d(${x}px, ${y}px, ${z}px) rotateY(${-theta}rad)`;
        }, 100);

        // Slow cinematic rotation of the whole world as we add photos
        world.style.transform = `rotateY(${(total - current) * 10}deg)`;

        current--;
        setTimeout(buildHelix, 1500);
    }

    function triggerBoom() {
        // Fly-through effect
        world.style.transition = "transform 1.5s cubic-bezier(0.7, 0, 0.3, 1)";
        world.style.transform = "translateZ(2000px) rotateY(180deg)";
        
        setTimeout(() => {
            flash.style.opacity = "1";
            
            setTimeout(() => {
                world.innerHTML = '';
                document.body.style.background = "radial-gradient(circle, #220000 0%, #000 100%)";
                document.body.classList.add('boom-active');
                flash.style.opacity = "0";
                
                // Start Vortex
                setInterval(spawnVortexHeart, 50);
            }, 500);
        }, 1000);
    }

    function spawnVortexHeart() {
        const h = document.createElement('div');
        h.className = 'vortex-heart';
        h.innerHTML = 'â¤';
        h.style.left = '50%'; h.style.top = '50%';
        document.body.appendChild(h);

        const angle = Math.random() * Math.PI * 2;
        const dist = Math.random() * 1000 + 500;
        
        const anim = h.animate([
            { transform: `translate(-50%, -50%) rotate(0deg) scale(0)`, opacity: 1 },
            { transform: `translate(${Math.cos(angle) * dist}px, ${Math.sin(angle) * dist}px) rotate(720deg) scale(2)`, opacity: 0 }
        ], { duration: 3000, easing: 'ease-out' });

        anim.onfinish = () => h.remove();
    }

    buildHelix();
</script>
</body>
</html>
